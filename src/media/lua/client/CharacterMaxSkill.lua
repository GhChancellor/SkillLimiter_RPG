---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by lele.
--- DateTime: 14/10/23 16:20
---

--[[
        errHandler.errMsg("CharacterTrait.readBook(character)",
                " moddata " .. pageBook.Character.TRAITS .. " not exists")
]]
---@class CharacterMaxSkill

local characterCreation = require("CharacterCreation")
local characterPz = require("lib/CharacterPZ")
local errHandler = require("lib/ErrHandler")
require("lib/CharacterBaseObj")

local CharacterMaxSkill = {}

---Defines maximum character level
---@param levelCurrentPerk int
---@return int
function CharacterMaxSkill.getCharacterMaxLevelPerkObj(levelCurrentPerk)
    if not levelCurrentPerk then
        errHandler.errMsg("CharacterMaxSkill.getCharacterMaxLevelPerkObj(levelCurrentPerk)",
                "levelCurrentPerk " .. errHandler.err.IS_NULL)
        return nil
    end

    local result

    if levelCurrentPerk == characterPz.EnumNumbers.ZERO then -- 0
        result = characterPz.EnumNumbers.FIVE -- max levelPerk 5
    elseif levelCurrentPerk == characterPz.EnumNumbers.ONE then -- 1
        result = characterPz.EnumNumbers.SIX -- max levelPerk 6
    elseif levelCurrentPerk == characterPz.EnumNumbers.TWO then -- 2
        result = characterPz.EnumNumbers.EIGHT -- max levelPerk 8
    elseif levelCurrentPerk >= characterPz.EnumNumbers.THREE then -- 3
        result = characterPz.EnumNumbers.TEN -- max levelPerk 10
    end

    return result
end

---Get Combat Max Level
---@param combatCurrentPerk int
---@return int Combat Max Level
function CharacterMaxSkill.getCharacterMaxLevelCombatObj(combatCurrentPerk)
    if not combatCurrentPerk then
        errHandler.errMsg("CharacterMaxSkill.getCharacterMaxLevelCombatObj(combatCurrentPerk)",
                "combatCurrentPerk " .. errHandler.err.IS_NULL)
        return nil
    end

    local result

    if combatCurrentPerk == characterPz.EnumNumbers.ZERO then -- 0
        result = characterPz.EnumNumbers.FIVE -- max levelPerk 5
    elseif combatCurrentPerk == characterPz.EnumNumbers.ONE then -- 1
        result = characterPz.EnumNumbers.SEVEN -- max levelPerk 7
    elseif combatCurrentPerk >= characterPz.EnumNumbers.TWO then -- 2
        result = characterPz.EnumNumbers.TEN -- max levelPerk 10
    end

    return result
end

---Get Combat Max Level
---@param combatCurrentPerk int
---@return int Combat Max Level
function CharacterMaxSkill.getCharacterMaxLevelCombatObj(combatCurrentPerk)
    if not combatCurrentPerk then
        errHandler.errMsg("CharacterMaxSkill.getCharacterMaxLevelCombatObj(combatCurrentPerk)",
                "combatCurrentPerk " .. errHandler.err.IS_NULL)
        return nil
    end

    local result

    if combatCurrentPerk == characterPz.EnumNumbers.ZERO then -- 0
        result = characterPz.EnumNumbers.FIVE -- max levelPerk 5
    elseif combatCurrentPerk == characterPz.EnumNumbers.ONE then -- 1
        result = characterPz.EnumNumbers.SEVEN -- max levelPerk 7
    elseif combatCurrentPerk >= characterPz.EnumNumbers.TWO then -- 2
        result = characterPz.EnumNumbers.TEN -- max levelPerk 10
    end

    return result
end

function CharacterMaxSkill.getCharacterProfessionMaxLevel( levelCurrentPerk )
    if not levelCurrentPerk then
        errHandler.errMsg("CharacterMaxSkill.getCharacterProfessionMaxLevel(levelCurrentPerk)",
                "levelCurrentPerk " .. errHandler.err.IS_NULL)
        return nil
    end

    return CharacterMaxSkill.getCharacterMaxLevelPerkObj(levelCurrentPerk)
end

--- Get Create Character Max Skill
---@param character IsoGameCharacter
---@return CharacterBaseObj getPerkDetails() -- table PerkFactory.Perk perk, int level, float xp
--- - IsoGameCharacter : zombie.characters.IsoGameCharacter
function CharacterMaxSkill.getCreateCharacterMaxSkill(character)
    if not character then
        errHandler.errMsg("CharacterMaxSkill.getCreateCharacterMaxSkill(character)",
                errHandler.err.IS_NULL_CHARACTERS)
        return nil
    end

    -- @type CharacterBaseObj
    local CharacterCreationObj = characterCreation.getCharacterCreation(character)

    for _, v in pairs(CharacterCreationObj:getPerkDetails()) do
        -- IdGroup add perk to list " no limits "
        if v:getIdGroup() == characterPz.EnumNumbers.ZERO then
            v:setLevel( characterPz.EnumNumbers.TEN )
        end

        -- IdGroup add perk to list " Profession trait and Perk  "
        if v:getIdGroup() == characterPz.EnumNumbers.ONE then
            v:setLevel( CharacterMaxSkill.getCharacterProfessionMaxLevel(v:getLevel()))
        end

        -- IdGroup add perk to list " combat "
        -- Flag add perk to list " combat "
        if v:getIdGroup() == characterPz.EnumNumbers.TWO then
            v:setLevel( CharacterMaxSkill.getCharacterMaxLevelCombatObj(0))
        end

        -- IdGroup add perk to list " Generic "
        if v:getIdGroup() == characterPz.EnumNumbers.THREE then
            v:setLevel( CharacterMaxSkill.getCharacterMaxLevelPerkObj(0))
        end

    end

    return CharacterCreationObj
end

return CharacterMaxSkill